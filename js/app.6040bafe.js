(function(){var e={3593:function(e,t,o){"use strict";var r=o(5361),n=o(6281),s=o(9242),a=o(3396);function i(e,t,o,r,n,s){const i=(0,a.up)("router-view"),l=(0,a.up)("main-layout");return n.isReady?((0,a.wg)(),(0,a.j4)(l,{key:0,title:n.title},{default:(0,a.w5)((()=>[(0,a.Wm)(i)])),_:1},8,["title"])):(0,a.kq)("",!0)}o(7658);var l=o(4870);function u(e,t,o,r,n,s){const i=(0,a.up)("robo-layout-header");return(0,a.wg)(),(0,a.j4)(i,{logoIcon:"images/logo-white.png",navigation:n.navigation,title:o.title},null,8,["navigation","title"])}var c=o(7464),d=o.n(c);function p(e){return new(d())(e.toString())}function m(e,t){return p(e).todp(t)}function w(e,t=0,o){return p(e).div(new(d())(10).pow(t.toString())).todp(o).toString()}d().set({toExpNeg:-31,toExpPos:31});var v={props:{title:{type:String,default:"Robonomics Dapp"}},data(){return{navigation:[{title:"Other",links:[{title:"Services",link:"page-services",type:"router"}]},{title:"Tokenomics",links:[{title:"Uniswap",link:"https://app.uniswap.org/#/swap?inputCurrency=0x7de91b204c1c737bcee6f000aaa6569cf7061cb7&outputCurrency=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",type:"external"},{title:"About XRT",link:"https://robonomics.network/xrt/",type:"external"}]},{title:"Tools",links:[{title:"Substrate Portal",link:"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/explorer",type:"external"},{title:"Subscan",link:"https://robonomics.subscan.io/",type:"external"},{title:"Polkassembly",link:"https://robonomics.polkassembly.io/",type:"external"}]},{title:"Kusama XCM",links:[{title:"Moonriver",link:"https://apps.moonbeam.network/moonriver",type:"external"},{title:"Solarbeam",link:"https://analytics.solarbeam.io/pairs/0x5261e0ce96289e6c3a16da45a2e52d1ab1a0e9c3",type:"external"}]}]}},watch:{"$store.state.robonomicsUIvue.polkadot.extensionObj":function(e){e.signer&&e.signer.signRaw&&this.$store.state.robonomicsUIvue.polkadot.address&&this.handlerAccount(this.$store.state.robonomicsUIvue.polkadot.address)},"$store.state.robonomicsUIvue.polkadot.address":{handler:function(e){e&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer.signRaw&&this.handlerAccount(e)},immediate:!0}},methods:{async handlerAccount(e){this.unsubscribeBalance&&this.unsubscribeBalance();const t=this.$store.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e));await this.$robonomics.accountManager.setSender(e,{type:t.type,extension:this.$store.state.robonomicsUIvue.polkadot.extensionObj}),this.unsubscribeBalance=await this.$robonomics.account.getBalance(e,(e=>{const t=e.free.sub(e.feeFrozen);this.$store.commit("polkadot/setBalanceXRT",m(w(t,this.$robonomics.api.registry.chainDecimals[0]),4))}))}}},f=o(89);const h=(0,f.Z)(v,[["render",u]]);var b=h,g={__name:"Main",props:{title:{type:String,default:"Robonomics Dapp"}},setup(e){const t=e;return(e,o)=>{const r=(0,a.up)("robo-layout");return(0,a.wg)(),(0,a.j4)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,l.SU)(b),{title:t.title},null,8,["title"]),(0,a.WI)(e.$slots,"default")])),_:3})}}};const y=g;var k=y,U=o(5743),S=o.n(U),_={name:"App",components:{MainLayout:k},data(){return{isReady:!1,title:""}},watch:{$route:{handler:function(e){this.title=e?.meta?.title},deep:!0,immediate:!0}},async created(){this.$store.commit("rws/setKey",{NODE_ENV:"production",BASE_URL:""}.VUE_APP_ROBONOMICS_UI_KEY),this.$store.dispatch("rws/init"),this.$store.commit("rws/setLinkActivate",this.$router.resolve({name:"rwsActivate"}).path),this.$store.commit("rws/setLinkList",this.$router.resolve({name:"rwsSetupsList"}).path),this.$store.commit("rws/setLinkSetup",this.$router.resolve({name:"rwsSetup"}).path),this.$store.commit("rws/setLinkDevices",this.$router.resolve({name:"telemetry"}).path),this.$store.commit("rws/setLinkUsers",this.$router.resolve({name:"rwsUsersList"}).path),this.$store.commit("rws/setLinkUseractivate",this.$router.resolve({name:"rwsUserSetup"}).path),this.$store.commit("rws/setLinkHaSetup",this.$router.resolve({name:"haSetup"}).path),this.$store.commit("ipfs/setGateways",["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/"]),this.$robonomicsReady((async()=>{if(this.isReady=!0,this.$store.state.robonomicsUIvue.rws.list&&this.$store.state.robonomicsUIvue.rws.list.length>0){const e=async(e,t)=>{const o=S()().valueOf(),r=Number(t);if(o&&r&&r-o<0){const t=await this.$robonomics.rws.getLedger(e);if(!t.isEmpty){if(null===t.value)return"";const e=t.value.issueTime.toNumber();let o=0;t.value.kind.isDaily&&(o=t.value.kind.value.days.toNumber());const r=864e5;return e+o*r}}return t},t=[];for(const o of this.$store.state.robonomicsUIvue.rws.list)t.push({...o,enddate:await e(o.owner,o.enddate)});this.$store.dispatch("rws/rewrite",t)}}))}};const W=(0,f.Z)(_,[["render",i]]);var x=W,A=o(3153),O=o(2146),R=o(6117),I=o(142);class N extends O.Uk{constructor(e,t={},o=null){super(e,o),this.extension=null,e.loadAll(t),this.setReady(!0)}async beforeSetSender(e,{type:t,extension:o}){this.extension=o;try{this.keyring.getPair(e)}catch(r){this.keyring.loadInjected(e,{},t)}}async afterSetSender(){this.account.meta.isInjected&&this.extension&&(this.api.setSigner(this.extension.signer),this.account.signMsg=async e=>(await this.extension.signer.signRaw({address:this.account.address,data:(0,R.c)((0,I.Rl)(e)),type:"bytes"})).signature)}}async function $(){try{return O.l.getInstance()}catch(e){}return await O.l.createInstance({endpoint:"wss://kusama.rpc.robonomics.network/"})}var H={install:async e=>{let t,o=!1;e.config.globalProperties.$robonomicsReady=e=>{o?e():t=e},e.config.globalProperties.$robonomics=await $(),e.config.globalProperties.$robonomics.setAccountManager(new N(A.ZP)),o=!0,t&&t()}},j=o(2483);const C=(0,a._)("p",null,"To open your local Home Assistant panel:",-1),P=(0,a._)("p",null," 1. Please enter in browser the following url: http://YOUR_LOCAL_IP:8123 ",-1),F=(0,a._)("p",null,"2. Login: enter your user address",-1),D=(0,a._)("p",null,"3. Password: enter password you created here",-1);function M(e,t,o,r,n,s){const i=(0,a.up)("robo-link"),l=(0,a.up)("robo-text"),u=(0,a.up)("robo-section"),c=(0,a.up)("form-check"),d=(0,a.up)("form-create"),p=(0,a.up)("robo-layout-section");return(0,a.wg)(),(0,a.j4)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{mark:"info",offset:"x0",width:"narrow"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{offset:"x0"},{default:(0,a.w5)((()=>[(0,a.Uk)(" You can create a password here to access your local Home Assistant account, if you already have an RWS subscription or have been added as a user to an RWS subscription. "),(0,a.Wm)(i,{href:"https://wiki.robonomics.network/docs/global-administration#granting-access-to-user"},{default:(0,a.w5)((()=>[(0,a.Uk)(" More on Wiki ")])),_:1})])),_:1})])),_:1}),(0,a.Wm)(u,{width:"narrow"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{onCheck:r.handleCheck},null,8,["onCheck"]),(0,a.Wm)(d,{"isCheсk":r.isCheсk,ownerAddress:r.ownerAddress,controllerAddress:r.controllerAddress,userSeed:r.userSeed},null,8,["isCheсk","ownerAddress","controllerAddress","userSeed"])])),_:1}),(0,a.Wm)(u,{mark:"info",marktitle:"What's next",offset:"x0",width:"narrow"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{offset:"x0"},{default:(0,a.w5)((()=>[C,P,F,D])),_:1})])),_:1})])),_:1})}function Y(e,t,o,r,n,i){const l=(0,a.up)("robo-text"),u=(0,a.up)("robo-grid-item"),c=(0,a.up)("robo-template-rws-activeselect"),d=(0,a.up)("robo-address-polkadot"),p=(0,a.up)("robo-input"),m=(0,a.up)("robo-button"),w=(0,a.up)("robo-grid");return(0,a.wg)(),(0,a.iD)("form",{onSubmit:t[2]||(t[2]=(0,s.iM)(((...e)=>r.validate&&r.validate(...e)),["prevent"]))},[(0,a.Wm)(w,{offset:"x0",gap:"x1",columns:"1"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{title:"3",offset:"x0"},{default:(0,a.w5)((()=>[(0,a.Uk)("User credits")])),_:1})])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{size:"small",block:"",label:"Choose RWS"})])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{address:r.address,"onUpdate:address":t[0]||(t[0]=e=>r.address=e),chain:"32",label:"User address"},null,8,["address"])])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"User seed (12 words)",modelValue:r.seed,"onUpdate:modelValue":t[1]||(t[1]=e=>r.seed=e),type:"password",tip:"The seed phrase provided here is essential for encrypting your data. We understand the sensitivity of this information and therefore, do not share it with any third parties or store it on our servers. As an extra layer of security, we recommend avoiding storing a large number of tokens in this account to reduce the risk of potential unauthorized access."},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{block:""},{default:(0,a.w5)((()=>[(0,a.Uk)("Check")])),_:1})])),_:1}),r.error?((0,a.wg)(),(0,a.j4)(u,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{highlight:"error"},{default:(0,a.w5)((()=>["require"===r.error?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.Uk)(" Oops! Looks like you missed filling in some required fields. Please fill in all required fields and try again. ")],64)):(0,a.kq)("",!0),"not-user-subscription"===r.error?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)(" Oops! It seems like your address has not been added to the RWS subscription. ")],64)):(0,a.kq)("",!0),"bad-seed"===r.error?((0,a.wg)(),(0,a.iD)(a.HY,{key:2},[(0,a.Uk)(" Oops! Seed does not match user address. ")],64)):(0,a.kq)("",!0)])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})],32)}function L(){try{return O.l.getInstance()}catch(e){console.log(e)}}var T=o(665),E=o(7281),B=o(9330),z=o(65),q={emits:["check"],setup(e,{emit:t}){const o=(0,l.iH)(""),r=(0,l.iH)(""),n=(0,l.iH)(!1),s=L();let i,u;const c=(0,z.oR)();(0,a.YP)((()=>c.state.robonomicsUIvue.rws.active),(async()=>{const e=c.state.robonomicsUIvue.rws.list.find((e=>e.owner===c.state.robonomicsUIvue.rws.active));e&&(i=e.owner,u=e.controller,console.log(i),console.log(u))}),{immediate:!0});const d=()=>!(!r.value||!o.value),p=async(t,o)=>{try{(0,E.Y)(t),(0,E.Y)(o)}catch(e){return!1}const r=await s.rws.getDevices(t);return!(r.isEmpty||!r.toHuman().includes(o))},m=()=>{try{const e=new T.Y,t=e.addFromUri(r.value,{},"ed25519");if((0,B.m)(o.value)===(0,B.m)(t.address))return!0}catch(n){console.log(n)}return!1},w=async()=>{d()?await p(i,o.value)?m()?n.value=!1:n.value="bad-seed":n.value="not-user-subscription":n.value="require",n.value?t("check",{"isCheсk":!1,ownerAddress:"",controllerAddress:"",userSeed:""}):t("check",{"isCheсk":!0,ownerAddress:i,controllerAddress:u,userSeed:r.value})};return{address:o,seed:r,error:n,validate:w}}};const Z=(0,f.Z)(q,[["render",Y]]);var V=Z,K=o(7139);function J(e,t,o,r,n,i){const l=(0,a.up)("robo-text"),u=(0,a.up)("robo-grid-item"),c=(0,a.up)("robo-input"),d=(0,a.up)("robo-button"),p=(0,a.up)("robo-grid");return(0,a.wg)(),(0,a.iD)("form",{onSubmit:t[2]||(t[2]=(0,s.iM)(((...e)=>r.createPassword&&r.createPassword(...e)),["prevent"]))},[(0,a.Wm)(p,{offset:"x1",gap:"x1",columns:"1",disabled:!o.isCheсk},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(l,{title:"3",offset:"x0"},{default:(0,a.w5)((()=>[(0,a.Uk)("New password")])),_:1})])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"New password",modelValue:r.password,"onUpdate:modelValue":t[0]||(t[0]=e=>r.password=e),type:"password"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"Repeat password",modelValue:r.passwordRepeat,"onUpdate:modelValue":t[1]||(t[1]=e=>r.passwordRepeat=e),type:"password"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{block:"",disabled:r.isDisabled},{default:(0,a.w5)((()=>[(0,a.Uk)("Submit")])),_:1},8,["disabled"])])),_:1}),r.error?((0,a.wg)(),(0,a.j4)(u,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{highlight:"error"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,K.zw)(r.error),1)])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disabled"])],32)}const X=(e=null)=>{const t=(0,l.iH)(e),o=(0,l.iH)([]),r=async()=>{if(t.value)try{(0,E.Y)(t.value);const e=await L().rws.getDevices(t.value);return void(o.value=e.map((e=>e.toHuman())))}catch(e){console.log(e)}o.value=[]};return(0,a.YP)(t,(async()=>{await r()}),{immediate:!0}),{owner:t,devices:o,loadDevices:r}},G=()=>L().api.consts.rws.referenceCallWeight,Q=async e=>{const t=await L().rws.getLedger(e);if(!t.isEmpty)return t.value},ee=864e5,te=async e=>{const t=await Q(e);if(!t)return-1;const o=t.freeWeight.toNumber(),r=t.lastUpdate.toNumber(),n=t.issueTime.toNumber(),s=G(),a=Date.now();let i=(()=>{let e=30*ee;return a<n+e?1e4:0})();const l=a-r;return Math.floor(o+s*i*l/1e9)},oe=(e=null)=>{const t=(0,l.iH)(e),o=(0,l.qj)({value:null}),{devices:r,loadDevices:n}=X(t),s=(0,a.Fl)((()=>{if(null===o.value)return"";const e=(0,l.IU)(o),t=e.value.issueTime.toNumber();let r=0;return e.value.kind.isDaily&&(r=e.value.kind.value.days.toNumber()),t+r*ee})),i=(0,a.Fl)((()=>{if(null===o.value)return 0;const e=(0,l.IU)(o);let t=0;return e.value.kind.isDaily&&(t=e.value.kind.value.days.toNumber()),t/30})),u=(0,a.Fl)((()=>(console.log(o.value),!(null===o.value||Date.now()>s.value)))),c=(0,a.Fl)((()=>null!==o.value)),d=async()=>{if(t.value)try{(0,E.Y)(t.value);const e=await Q(t.value);if(e)return void(o.value=e)}catch(e){console.log(e)}o.value=null};return(0,a.YP)(t,(async()=>{await d()}),{immediate:!0}),{owner:t,dataRaw:o,hasSubscription:c,isActive:u,countMonth:i,validUntil:s,loadLedger:d,devices:r,loadDevices:n}},re=async(e,t)=>{if(!t){const e=L();if(!e.accountManager.account)throw new Error("Signer required");t=e.accountManager.account.address}return(await e.paymentInfo(t)).weight.toNumber()},ne=async(e,t)=>{const o=await te(t);if(o<0)throw new Error(`Not found ledger ${t}`);const r=await re(e);if(r>o)throw new Error(`The origin account have no enough free weight to process these call. Call weight ${r}, Free weight ${o}`)},se=()=>{const e=L(),t=(0,l.iH)(null),o=(0,l.iH)(null),r=(0,l.iH)(!1),n=async(n,s=!1)=>{t.value=null,o.value=null,r.value=!0;try{s&&(await ne(n,s),e.accountManager.useSubscription(s)),t.value=await e.accountManager.signAndSend(n),console.log("tx",t.value.block,t.value.tx)}catch(a){o.value=a.message}return r.value=!1,s&&e.accountManager.useSubscription(!1),t};return{error:o,process:r,result:t,send:n}};var ae=o(2629),ie={props:{"isCheсk":Boolean,ownerAddress:String,controllerAddress:String,userSeed:String},setup(e){const{"isCheсk":t,ownerAddress:o,controllerAddress:r,userSeed:n}=(0,l.BK)(e),s=(0,l.iH)(""),i=(0,l.iH)(""),u=(0,l.iH)(""),c=L(),d=se(),p=(0,z.oR)();let m;(0,a.YP)(n,(()=>{if(t.value)try{const e=new T.Y({ss58Format:c.api?.registry.chainSS58});return void(m=e.addFromUri(n.value,{},"ed25519"))}catch(u){console.log(u)}m=null}),{immediate:!0});const w=(e,t)=>{const o=m.encryptMessage(e,(0,R.c)((0,ae.m)(t)));return(0,R.c)(o)};let v,f;(0,a.m0)((()=>{t.value&&h.value&&b.value?(v=w(s.value,m.address),f=w(s.value,r.value)):(v="",f=""),console.log({passwordForRecovery:v,passwordForAdmin:f})}));const h=(0,a.Fl)((()=>!(!s.value||!i.value))),b=(0,a.Fl)((()=>s.value===i.value)),g=(0,a.Fl)((()=>d.process.value?(console.log("process"),!0):t.value?h.value?b.value?(!f||!v)&&(console.log("passwordForAdmin passwordForRecovery"),!0):(console.log("checkPasswordsMatch"),!0):(console.log("validateRequire"),!0):(console.log("isCheсk"),!0))),y=async()=>{if(!t.value)return;c.accountManager.account=m;const e=await c.datalog.write(JSON.stringify({subscription:o.value,ha:r.value,admin:f,user:v}));await d.send(e,o.value),d.error.value&&("Cancelled"!==d.error.value?u.value=d.error.value:console.log("calcel"));const n=p.state.robonomicsUIvue.polkadot.accounts.find((e=>e.address===p.state.robonomicsUIvue.polkadot.address));await c.accountManager.setSender(n.address,{type:n.type,extension:p.state.robonomicsUIvue.polkadot.extensionObj})};return{password:s,passwordRepeat:i,error:u,isDisabled:g,createPassword:y}}};const le=(0,f.Z)(ie,[["render",J]]);var ue=le,ce={components:{FormCheck:V,FormCreate:ue},setup(){const e=(0,l.iH)(!1),t=(0,l.iH)(""),o=(0,l.iH)(""),r=(0,l.iH)(""),n=n=>{e.value=n.isCheсk,t.value=n.ownerAddress,o.value=n.controllerAddress,r.value=n.userSeed};return{"isCheсk":e,ownerAddress:t,controllerAddress:o,userSeed:r,handleCheck:n}}};const de=(0,f.Z)(ce,[["render",M]]);var pe=de,me={__name:"Home",setup(e){const t=(0,z.oR)(),o=(0,a.Fl)((()=>t.state.robonomicsUIvue.rws.list));return(e,r)=>{const n=(0,a.up)("robo-video"),s=(0,a.up)("robo-icon"),i=(0,a.up)("robo-text"),u=(0,a.up)("robo-grid"),c=(0,a.up)("robo-button"),d=(0,a.up)("robo-card"),p=(0,a.up)("robo-link"),m=(0,a.up)("robo-grid-item"),w=(0,a.up)("robo-layout-section");return(0,a.wg)(),(0,a.j4)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{offset:"x0",gap:"x1",valign:"start",galign:"start",minColumnWidth:"550px",maxColumnWidth:"1fr"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{autoplay:"",loop:"",sources:[{src:"https://crustipfs.art/ipfs/QmStCDsEHCYwVYvnDdmZBMnobPmrgZx3iJLm65b8XNzKQa",type:"video/mp4"}],script:"<p>Robonomics is a decentralized cloud service that can be used to enhance\n                your smart home system. It addresses two main problems: the lack of\n                control over data shared with vendors or third parties, and the vulnerability of\n                smart homes to centralized cloud server shutdowns.</p>\n                <p>With Robonomics, you can take advantage of its secure,\n                  serverless, and decentralized cloud service to improve the functionality of\n                  your smart home. Plus, you can use it with a wide range of Zigbee smart devices\n                  to automate and control various aspects of your home.</p>\n                <p>Installing Robonomics on top of Home Assistant is easy, and there are\n                   several options to choose from. Simply select the method that works best for you\n                   and your smart home on wiki.robonomics.network.</p>"},null,8,["sources"]),(0,a.Wm)(m,{align:"stretch"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{offset:"x0",gap:"x1",minColumnWidth:"270px",maxColumnWidth:"1fr"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{fixedButton:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{offset:"x0",gap:"x05",valign:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{icon:"current-version",size:"big"}),(0,a._)("div",null,[(0,a.Wm)(i,{title:"4"},{default:(0,a.w5)((()=>[(0,a.Uk)("Your RWS subscriptions")])),_:1})])])),_:1}),(0,a.Wm)(c,{router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.list},{default:(0,a.w5)((()=>[(0,a.Uk)(" View details ")])),_:1},8,["router"])])),_:1}),(0,a.Wm)(d,{pale:(0,l.SU)(o)?.length<1,fixedButton:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{offset:"x0",gap:"x05",valign:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{icon:"plug",size:"big"}),(0,a._)("div",null,[(0,a.Wm)(i,{title:"4"},{default:(0,a.w5)((()=>[(0,a.Uk)("Control smart devices")])),_:1})])])),_:1}),(0,a.Wm)(c,{router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.devices,disabled:(0,l.SU)(o)?.length<1},{default:(0,a.w5)((()=>[(0,a.Uk)(" Manage devices ")])),_:1},8,["router","disabled"])])),_:1},8,["pale"]),(0,a.Wm)(d,{pale:(0,l.SU)(o)?.length<1,fixedButton:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{offset:"x0",gap:"x05",valign:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{icon:"user-group",size:"big"}),(0,a._)("div",null,[(0,a.Wm)(i,{title:"4"},{default:(0,a.w5)((()=>[(0,a.Uk)("Share your telemetry")])),_:1})])])),_:1}),(0,a.Wm)(c,{router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.users,disabled:(0,l.SU)(o)?.length<1},{default:(0,a.w5)((()=>[(0,a.Uk)(" Manage Users ")])),_:1},8,["router","disabled"])])),_:1},8,["pale"]),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{title:"4",offset:"x0"},{default:(0,a.w5)((()=>[(0,a.Uk)("Need help?")])),_:1}),(0,a.Wm)(u,{gap:"x05",offset:"x1"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{size:"small",weight:"bold"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{href:"https://wiki.robonomics.network"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Wiki ")])),_:1}),(0,a.Uk)(" - Tutorials ")])),_:1}),(0,a.Wm)(i,{size:"small",weight:"bold"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{href:"https://github.com/airalab/dapp.robonomics.network"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Github")])),_:1}),(0,a.Uk)(" - Bugs & improvements ")])),_:1}),(0,a.Wm)(i,{size:"small",weight:"bold"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{href:"https://discord.gg/JpaN2XAmqY"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Discord ")])),_:1}),(0,a.Uk)(" - Team support ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}};const we=me;var ve=we;function fe(e,t,o,r,n,s){const i=(0,a.up)("robo-template-rws-activate"),l=(0,a.up)("robo-layout-section");return(0,a.wg)(),(0,a.j4)(l,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,{price:r.price,activationtime:"2",available:r.freeAuctions,onOnRwsActivate:r.onActivate},null,8,["price","available","onOnRwsActivate"])])),_:1})}const he=()=>{const e=(0,l.iH)(null),t=L();t.accountManager.account&&(e.value=t.accountManager.account.address);const o=t.accountManager.onChange((t=>{e.value=t.address}));return{account:e,unsubscribe:o}},be=e=>{const t=(0,l.iH)(null),o=L();let r;return(0,a.YP)(e,(async()=>{r&&r(),r=await o.account.getBalance(e.value,(e=>{t.value=e.free.sub(e.feeFrozen).toNumber()}))})),{balance:t,unsubscribe:r}};var ge=o(1737),ye={setup(){const e=(0,l.iH)(0),t=(0,l.iH)(0);let o=null;const r=L(),{account:n,unsubscribe:s}=he(),{balance:i,unsubscribe:u}=be(n),c=oe(n),d=X(n);(async()=>{t.value=(await r.rws.getFreeAuctions()).length,o=await r.events.onBlock((async()=>{t.value=(await r.rws.getFreeAuctions()).length}));const n=await r.rws.getMinimalBid();e.value=n.add((0,ge.G)(1))})(),(0,a.Ah)((()=>{o&&o(),u&&u(),s()}));const p=se(),m=async o=>{if(!i.value||(0,ge.G)(i.value).add((0,ge.G)(1e9)).lt(e.value))return o("error","Subscription can not be activated due to unsuffcicient XRT balance");if(t.value<=0)return o("error","There are no available subscriptions");if(c.hasSubscription.value&&c.isActive.value)return o("error","You have an active subscription");let s=r.rws.bid(Number(await r.rws.getFirtsFreeAuction()),e.value);if(d.devices.value.includes(n.value)||(s=r.api.tx.utility.batch([s,r.rws.setDevices([...d.devices.value,n.value])])),await p.send(s),p.error.value)return void("Cancelled"!==p.error.value?o("error",p.error.value):o("calcel"));const l=await r.events.onBlock((()=>{c.loadLedger()})),u=(0,a.m0)((()=>{c.hasSubscription.value&&c.isActive.value&&(u(),l(),o("ok"))}))},v=(0,a.Fl)((()=>w(e.value,r.api.registry.chainDecimals[0])));return{freeAuctions:t,price:v,onActivate:m}}};const ke=(0,f.Z)(ye,[["render",fe]]);var Ue=ke;function Se(e,t,o,r,n,s){const i=(0,a.up)("robo-template-rws-setup"),l=(0,a.up)("robo-layout-section");return(0,a.wg)(),(0,a.j4)(l,{rwsrecover:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{owner:r.ownerNew,"onUpdate:owner":t[0]||(t[0]=e=>r.ownerNew=e),controller:r.controllerNew,"onUpdate:controller":t[1]||(t[1]=e=>r.controllerNew=e),scontroller:r.scontrollerNew,"onUpdate:scontroller":t[2]||(t[2]=e=>r.scontrollerNew=e),name:r.nameNew,"onUpdate:name":t[3]||(t[3]=e=>r.nameNew=e),enddate:r.enddateNew,"onUpdate:enddate":t[4]||(t[4]=e=>r.enddateNew=e),onOnRwsSetup:r.onSetup},null,8,["owner","controller","scontroller","name","enddate","onOnRwsSetup"])])),_:1})}var _e={setup(){const e=(0,l.iH)(null),t=(0,l.iH)(null),o=(0,l.iH)(null),r=(0,l.iH)(null),n=oe(e),s=e=>{e("ok")};return{ownerNew:e,controllerNew:t,scontrollerNew:o,nameNew:r,enddateNew:n.validUntil,onSetup:s}}};const We=(0,f.Z)(_e,[["render",Se]]);var xe=We;function Ae(e,t,o,r,n,s){const i=(0,a.up)("robo-template-rws-setups-empty"),l=(0,a.up)("robo-section"),u=(0,a.up)("robo-layout-section"),c=(0,a.up)("robo-template-rws-setup-listitem"),d=(0,a.up)("robo-grid"),p=(0,a.up)("robo-button");return r.rws?.length<1?((0,a.wg)(),(0,a.j4)(u,{key:0,rwsrecover:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{width:"narrow",gcenter:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i)])),_:1})])),_:1})):((0,a.wg)(),(0,a.j4)(u,{key:1,rwsrecover:"",rwssave:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{offset:"x0",width:"narrow"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{offset:"x1",gap:"x1"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.rws,((e,t)=>((0,a.wg)(),(0,a.j4)(c,{key:t,owner:e.owner,"onUpdate:owner":t=>e.owner=t,controller:e.controller,"onUpdate:controller":t=>e.controller=t,scontroller:e.scontroller,"onUpdate:scontroller":t=>e.scontroller=t,name:e.name,"onUpdate:name":t=>e.name=t,enddate:e.enddate,"onUpdate:enddate":t=>e.enddate=t,onEdit:r.onEdit,onOnRwsDelete:r.onDelete},null,8,["owner","onUpdate:owner","controller","onUpdate:controller","scontroller","onUpdate:scontroller","name","onUpdate:name","enddate","onUpdate:enddate","onEdit","onOnRwsDelete"])))),128))])),_:1}),(0,a.Wm)(p,{block:"",router:r.store.state.robonomicsUIvue.rws.links.setup},{default:(0,a.w5)((()=>[(0,a.Uk)(" + Add new rws ")])),_:1},8,["router"])])),_:1})])),_:1}))}var Oe={setup(){const e=(0,z.oR)(),t=(0,a.Fl)((()=>e.state.robonomicsUIvue.rws.list));let o=e=>{e("ok")},r=e=>{e("ok")};return{store:e,rws:t,onEdit:o,onDelete:r}}};const Re=(0,f.Z)(Oe,[["render",Ae]]);var Ie=Re;function Ne(e,t,o,r,n,s){const i=(0,a.up)("robo-template-rws-user-setup"),l=(0,a.up)("robo-layout-section");return(0,a.wg)(),(0,a.j4)(l,{rwsrecover:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{address:r.addressNew,"onUpdate:address":t[0]||(t[0]=e=>r.addressNew=e),name:r.nameNew,"onUpdate:name":t[1]||(t[1]=e=>r.nameNew=e),onOnUserSetup:r.onSetup},null,8,["address","name","onOnUserSetup"])])),_:1})}var $e={setup(){let e=(0,l.iH)(null),t=(0,l.iH)(null);const o=(0,z.oR)();let r=(0,l.iH)(o.state.robonomicsUIvue.rws.active);(0,a.YP)((()=>o.state.robonomicsUIvue.rws.active),(()=>{r.value=o.state.robonomicsUIvue.rws.active}));const n=L(),s=se(),i=X(r),u=async t=>{if(!i.devices.value.includes(e.value)){const o=await n.rws.setDevices([...i.devices.value,e.value]);if(await s.send(o),s.error.value)return void("Cancelled"!==s.error.value?t("error",s.error.value):t("calcel"))}t("ok")};return{addressNew:e,nameNew:t,onSetup:u}}};const He=(0,f.Z)($e,[["render",Ne]]);var je=He,Ce={__name:"RwsUsersList",setup(e){const t=(0,z.oR)(),o=(0,a.Fl)((()=>t.state.robonomicsUIvue.rws.list)),r=(0,a.Fl)((()=>t.state.robonomicsUIvue.rws.active)),n=(0,a.Fl)((()=>t.getters["rws/users"])),s=e=>{e("ok")},i=e=>{e("ok")};return(e,u)=>{const c=(0,a.up)("robo-template-rws-activeselect"),d=(0,a.up)("robo-template-rws-users-empty"),p=(0,a.up)("robo-section"),m=(0,a.up)("robo-layout-section"),w=(0,a.up)("robo-template-rws-user-listitem"),v=(0,a.up)("robo-grid"),f=(0,a.up)("robo-button");return(0,l.SU)(o)?.length<1||!(0,l.SU)(n)||(0,l.SU)(n).length<1?((0,a.wg)(),(0,a.j4)(m,{key:0,rwsrecover:""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{width:"narrow",gcenter:""},{default:(0,a.w5)((()=>[(0,l.SU)(o)?.length>1?((0,a.wg)(),(0,a.j4)(c,{key:0,block:"",label:"Selected RWS"})):(0,a.kq)("",!0),(0,a.Wm)(d)])),_:1})])),_:1})):((0,a.wg)(),(0,a.j4)(m,{key:1,rwsrecover:"",rwssave:""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{offset:"x0",width:"narrow"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{offset:"x1",gap:"x1"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,l.SU)(n),((e,t)=>((0,a.wg)(),(0,a.j4)(w,{key:t,owner:(0,l.SU)(r),address:e.address,"onUpdate:address":t=>e.address=t,name:e.name,"onUpdate:name":t=>e.name=t,onEdit:s,onOnUserDelete:i},null,8,["owner","address","onUpdate:address","name","onUpdate:name"])))),128))])),_:1}),(0,a.Wm)(f,{block:"",router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.useractivate},{default:(0,a.w5)((()=>[(0,a.Uk)(" + Add user ")])),_:1},8,["router"])])),_:1})])),_:1}))}}};const Pe=Ce;var Fe=Pe;function De(e,t,o,r,n,s){const i=(0,a.up)("robo-template-devices-layout");return(0,a.wg)(),(0,a.j4)(i,{onUpdate:r.onUpdate,datalog:r.datalog,config:r.config},null,8,["onUpdate","datalog","config"])}var Me=o(6251),Ye=o(4161);const Le=e=>e.replaceAll("'",'"').replaceAll("\\","").replaceAll('""','"').replaceAll("True","true").replaceAll("False","false").replaceAll("None",'"None"');var Te={setup(){const e=(0,l.iH)(),t=(0,l.iH)(),o=(0,l.iH)(""),r=(0,l.iH)(""),n=L(),s=(0,z.oR)(),i=new T.Y({ss58Format:n.api?.registry.chainSS58});let u;const c=async e=>{const t=await n.datalog.read(e);return!!t.length&&(0,Me.z)(t[t.length-1][1])},d=async e=>{if(!e)return;const t=await n.twin.getTwinByOwner(e);if(!t)return;const o=Object.keys(t).find((o=>t[o]===e));return O.P6.hexToCid(o)},p=e=>{if(!u)return;const t=u.decryptMessage(e,u.publicKey);return(0,Me.z)(t)},m=async e=>{if(!e)return{};const t=await Ye.Z.get(`${s.state.robonomicsUIvue.ipfs.activegateway}${e}`),o=p(t.data);try{return JSON.parse(o)}catch(r){console.log("error parse 1"),console.log(o)}try{return JSON.parse(Le(o))}catch(r){console.log("error parse 2"),console.log(o)}return{}};(0,a.YP)((()=>s.state.robonomicsUIvue.rws.active),(async()=>{const e=s.state.robonomicsUIvue.rws.list.find((e=>e.owner===s.state.robonomicsUIvue.rws.active));e&&(u=i.addFromUri(e.scontroller,{},"ed25519"),r.value=await d(u.address),o.value=await c(u.address))})),(0,a.YP)(o,(async()=>{const t=await m(o.value),r=t.twin_id;delete t.twin_id,e.value={devices:t,twin_id:r},console.log("datalog"),console.log(JSON.stringify(e.value))})),(0,a.YP)(r,(async()=>{t.value=await m(r.value),console.log("config"),console.log(JSON.stringify(t.value))})),(async()=>{const e=s.state.robonomicsUIvue.rws.list.find((e=>e.owner===s.state.robonomicsUIvue.rws.active));if(e)try{u=i.addFromUri(e.scontroller,{},"ed25519"),r.value=await d(u.address),o.value=await c(u.address)}catch(t){console.log(t)}})();const w=async n=>{t.value={},e.value={};try{u?(r.value=await d(u.address),o.value=await c(u.address),n("ok")):n("error","Not found controller")}catch(s){console.log(s),n("error",s.message)}};return{datalog:e,config:t,configCid:r,onUpdate:w}}};const Ee=(0,f.Z)(Te,[["render",De]]);var Be=Ee;const ze=[{path:"/",name:"Home",component:ve,meta:{title:"Dashboard"}},{path:"/rws-activate",name:"rwsActivate",component:Ue,meta:{title:"RWS activation"}},{path:"/rws-setup",name:"rwsSetup",component:xe,meta:{title:"RWS setup"}},{path:"/rws-setups-list",name:"rwsSetupsList",component:Ie,meta:{title:"Your RWS setups"}},{path:"/rws-user-setup",name:"rwsUserSetup",component:je,meta:{title:"RWS add user"}},{path:"/rws-users-list",name:"rwsUsersList",component:Fe,meta:{title:"Users in your RWS"}},{path:"/telemetry",name:"telemetry",component:Be,meta:{title:"Smart devices"}},{path:"/hasetup",name:"haSetup",component:pe,meta:{title:"HA setup"}}],qe=(0,j.p7)({history:(0,j.r5)(),routes:ze});var Ze=qe;const Ve=(0,z.MT)({state:{name:"Vue"}});var Ke=Ve,Je={install:e=>{e.config.globalProperties.$filters={balance(e,t,o){return"string"===typeof e||"number"===typeof e?`${w(e,t,4)} ${o}`:""}}}};window.Buffer=r.lW;const Xe=(0,s.ri)(x);Xe.use(Ze).use(Ke).use(Je).use(H).use(n.robonomicsUI,{store:Ke}).mount("#app")},5856:function(){},6601:function(){},173:function(){},5024:function(){}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=e,function(){o.amdO={}}(),function(){var e=[];o.O=function(t,r,n,s){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],n=e[c][1],s=e[c][2];for(var i=!0,l=0;l<r.length;l++)(!1&s||a>=s)&&Object.keys(o.O).every((function(e){return o.O[e](r[l])}))?r.splice(l--,1):(i=!1,s<a&&(a=s));if(i){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[r,n,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};o.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"===typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"===typeof r.then)return r}var s=Object.create(null);o.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var i=2&n&&r;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){a[e]=function(){return r[e]}}));return a["default"]=function(){return r},o.d(s,a),s}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,s,a=r[0],i=r[1],l=r[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(n in i)o.o(i,n)&&(o.m[n]=i[n]);if(l)var c=l(o)}for(t&&t(r);u<a.length;u++)s=a[u],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(c)},r=self["webpackChunkrobonomics_dapp"]=self["webpackChunkrobonomics_dapp"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(3593)}));r=o.O(r)})();
//# sourceMappingURL=app.6040bafe.js.map